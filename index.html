<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<meta name="description" content="Traveling through space and time is hard, but writing clean Reactive Forms in Angular doesn’t have to be, thanks to the Control Value Accessor interface! Fear not, unlike wormholes, elements using the CVA aren’t prone to sudden collapse or high radiation, they’re just going to help you write cleaner, clearer code faster, and solve some formerly complicated problems.">
		<meta name="keywords" content="Jennifer Wadella, software engineer, women in tech speaker, female software engineer, female speaker, female founder, non-profit consultant, female coder, Kansas City Women in Technology, kcwit, kcwit founder, women engineers, girls in tech, women in tech, coding &amp; cocktails, coding &amp; cupcakes, CoderDojoKC">
		<meta itemprop="name" content="The Control Value Accessor – Like a Wormhole in Space for Your Forms, Only More Useful!">
		<meta itemprop="description" content="Traveling through space and time is hard, but writing clean Reactive Forms in Angular doesn’t have to be, thanks to the Control Value Accessor interface! Fear not, unlike wormholes, elements using the CVA aren’t prone to sudden collapse or high radiation, they’re just going to help you write cleaner, clearer code faster, and solve some formerly complicated problems.">
		<meta itemprop="image" content="http://tehfedaykin.github.io/WormholesandCVAs/img/cvacover.png">
		<meta property="og:title" content="The Control Value Accessor – Like a Wormhole in Space for Your Forms, Only More Useful!">
		<meta property="og:type" content="website">
		<meta property="og:image" content="http://tehfedaykin.github.io/WormholesandCVAs/img/cvacover.png">
		<meta property="og:url" content="http://tehfedaykin.github.io/WormholesandCVAs">
		<meta property="og:description" content="Traveling through space and time is hard, but writing clean Reactive Forms in Angular doesn’t have to be, thanks to the Control Value Accessor interface! Fear not, unlike wormholes, elements using the CVA aren’t prone to sudden collapse or high radiation, they’re just going to help you write cleaner, clearer code faster, and solve some formerly complicated problems.">
		<meta property="twitter:card" content="twitter:card">
		<meta property="twitter:title" content="The Control Value Accessor – Like a Wormhole in Space for Your Forms, Only More Useful!">
		<meta property="twitter:creator" content="@likeOMGitsFEDAY">
		<meta property="twitter:image" content="http://tehfedaykin.github.io/WormholesandCVAs/img/cvacover.png">
		<meta property="twitter:url" content="http://tehfedaykin.github.io/WormholesandCVAs">
		<meta property="twitter:description" content="Traveling through space and time is hard, but writing clean Reactive Forms in Angular doesn’t have to be, thanks to the Control Value Accessor interface! Fear not, unlike wormholes, elements using the CVA aren’t prone to sudden collapse or high radiation, they’re just going to help you write cleaner, clearer code faster, and solve some formerly complicated problems.">

		<title>The Control Value Accessor – Like a Wormhole in Space for Your Forms, Only More Useful!</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section id="title">
					<h1>Control Value Accessor<br /></h1>
					<h2>Like a Wormhole in Space for 
						<br />Your Forms, Only More Useful!</h2>
					<h3 class="small">Jennifer Wadella</h3>
				</section>
				<section id="me">
					<div class="speaker-title">
						<div class="flex-1">
							<img class="circle plain" src="img/jennifer-wadella-headshot.jpeg" alt="Jennifer Wadella headshot">
						</div>
						<div class="flex-2">
							<div class="">
								<h2>Jennifer Wadella</h2>
								<h3><a href="http://twitter.com/likeOMGitsFEDAY">@likeOMGitsFEDAY</a></h3>
							</div>
						</div>
					</div>
					<ul class="small">
						<li>JavaScript Developer</li>
						<li>Community Organizer</li>
						<li>Crazy plant lady</li>
					</ul>
				</section>
				<!----------------------------------------->
				<section id="what-is-a-wormhole">
					<h2>What is a wormhole? </h2>
				</section>
				<section id="wormhole-definition">
					<h3>a theoretical structure of space-time envisioned as a tunnel connecting points that are separated in space and time</h3>
				</section>
				<section id="wormhole-image">
					<img class="plain" src="img/wormhole.webp" />
				</section>
				<section id="demogorgon">
						<img class="plain" src="img/demogorgon.gif" />
					</section>
				<section id="neil-degrasse">
					<img class="plain" src="img/neildegrassespace.gif" />
				</section>
				<!----------------------------------------->
				<section id="CVA">
				<h2>The Control Value Accessor</h2>
				</section>
				<section id="CVA-definition">
					<h3>Defines an interface that acts as a bridge between the Angular forms API and a native element in the DOM.</h3>
					<p class="small"><a target="_blank" href="https://github.com/angular/angular/blob/master/packages/forms/src/directives/control_value_accessor.ts">cva source code</a></p>
				</section>
				<section id="implement-CVA">
					<h2>What can we do with this?</h2>
					<p class="fragment">Implement this interface to create a custom form control directive that integrates with Angular forms.</p>
				</section>
				<section id="wormhole-cva">
					<svg height="500px" width="700px"
						xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> 
						<style>
								.text { font: bold 30px sans-serif; fill: #ffffff; stroke:#000000;stroke-width:1px; }
						
							</style>      
						<image xlink:href="img/wormhole.webp" height="100%" />
						<text x="150" y="120" class="text" >Custom Directive</text>
						<text x="300" y="280" class="text" transform="rotate(90,350,300)" style="fill: #000">Value</text>

						<text x="200" y="400" class="text">Form</text>
					</svg>
				</section>
				<!----------------------------------------->
				<section id="how-to-use-intro">
					<h2>Sounds Great!</h2>
					<p>How do I use it?</p>
					<img class="plain" src="img/curiositydoor.gif" />
				</section>
				<section id="typescript-interface">
					<h2>Typescript with Classes & Interfaces</h2>
					<p class="fragment">Classes implementing interfaces <b>must</b> follow the structure described by the interface.</p>
				</section>
				<section id="cva-interface">
					<h2>CVA Interface</h2>
					<pre><code data-trim data-noescape>
					interface ControlValueAccessor {
					  writeValue(obj: any): void
					  registerOnChange(fn: any): void
					  registerOnTouched(fn: any): void
					  setDisabledState(isDisabled: boolean)?: void
					}
					</code></pre>
				</section>
				<section id="writeValue">
					<h2>write Value</h2>
					<pre><code data-trim data-noescape>
					interface ControlValueAccessor {
					  <mark>writeValue(obj: any): void</mark>
					  registerOnChange(fn: any): void
					  registerOnTouched(fn: any): void
					  setDisabledState(isDisabled: boolean)?: void
					}
					</code></pre>
					<p><br />Writes a new value to the element.</p>
				</section>
				<section id="onChange">
					<h2>register On Change</h2>
					<pre><code data-trim data-noescape>
					interface ControlValueAccessor {
					  writeValue(obj: any): void
					  <mark>registerOnChange(fn: any): void</mark>
					  registerOnTouched(fn: any): void
					  setDisabledState(isDisabled: boolean)?: void
					}
					</code></pre>
					<p><br />Registers a callback function that is called when
					<br />the control's value changes in the UI.</p>
				</section>
				<section id="onTouched">
					<h2>register On Touched</h2>
					<pre><code data-trim data-noescape>
					interface ControlValueAccessor {
					  writeValue(obj: any): void
					  registerOnChange(fn: any): void
					  <mark>registerOnTouched(fn: any): void</mark>
					  setDisabledState(isDisabled: boolean)?: void
					}
					</code></pre>
					<p><br />Registers a callback function is called by the forms
					<br />API on initialization to update the form model on blur.</p>
				</section>
				<section id="setDisabled">
					<h2>set Disabled State</h2>
					<pre><code data-trim data-noescape>
					interface ControlValueAccessor {
					  writeValue(obj: any): void
					  registerOnChange(fn: any): void
					  registerOnTouched(fn: any): void
					  <mark>setDisabledState(isDisabled: boolean)?: void</mark>
					}
					</code></pre>
					<p><br />Function that is called by the forms API when the control 
					<br />status changes to or from 'DISABLED'. Depending on the status, 
					<br /> it enables or disables the appropriate DOM element.</p>
				</section>
				<!----------------------------------------->
				<section id="creating-custom-form">
					<h2>Creating a custom form element</h2>
				</section>
				<section id="setup">
					<h2>Sample setup</h2>
					<pre><code data-trim>
					import { Component } from '@angular/core';
					import { FormBuilder, FormGroup, FormControl } from '@angular/forms';
					
					@Component({
					  selector: 'app-root',
						template: `
						<form  [formGroup]="myForm">
						  <div class="form-group">
						    <label for="name">Name</label>
						    <!-- a custom input here -->
						  </div>
						</form>`,
					})
          export class AppComponent {
						myForm: FormGroup;
						
						constructor(private formBuilder: FormBuilder ) {
              this.myForm = formBuilder.group({
                name: new FormControl('testing')
              });
              this.onChanges();
						}

						onChanges() {
              this.myForm.get('name').valueChanges.subscribe((val) => {
								console.log(`val changed to ${val}`);
							});
					  }
					}
					</code></pre>
				</section>
				<section id="meh-component">
					<p>wrapper component</p>
					<pre><code data-trim>
					import { Component, OnInit, Output, EventEmitter } from '@angular/core';

					@Component({
					  selector: 'meh-component',
					  template: `<input (change)="mehChange($event)" type="text" />`,
					})
					export class MehComponent implements OnInit {
					  @Output() mehValueChange = new EventEmitter();

					  mehChange($event) {
					    this.mehValueChange.emit($event.currentTarget.value);
					  }
					}						
					</code></pre>
					<p>parent component w/ form</p>
					<pre><code data-trim data-noescape>
						changeListener(val) {
						  this.myForm.get('name').patchValue(val);
						}
					</code></pre>
				</section>
				<section id="pitfalls">
					<h2>pitfalls</h2>
					<ul>
						<li class="fragment">Managing additional methods for outputting</li>
						<li class="fragment">Having to use additional method of .patchValue on form control</li>
						<li class="fragment">Validation?!?!?!</li>
					</ul>
				</section>
				<section id="cva applied">
					<h2>Control Value Accessor Applied</h2>
				</section>
				<section id="implementation">
					<h2>Implementation</h2>
					<p>We need to register the `NG_VALUE_ACCESSOR` provider and implement the `ControlValueAccessor` methods.</p>
				</section>
				<section id="basic-wrapper">
					<h2>Basic CVA Implementation</h2>
					<pre><code data-trim>
					import { Component } from '@angular/core';
					import { NG_VALUE_ACCESSOR, ControlValueAccessor } from '@angular/forms';
							
					@Component({
						selector: 'my-sweet-component',
						template: `<input (change)="sweetChange($event)" type="text" />`,
						providers: [{
							provide: NG_VALUE_ACCESSOR,
							useExisting: MySweetComponent,
							multi: true
						}]
					})
					export class MySweetComponent implements ControlValueAccessor {
						_value: any;
						onChange;
						onTouched;

						writeValue(val) {
							this._value = val;
						}
						registerOnChange( fn : any ) : void {this.onChange = fn;}
						registerOnTouched( fn : any ) : void {this.onTouched = fn;}
						
						sweetChange($event) {
							this.writeValue($event.currentTarget.value);
							this.onTouched();
							this.onChange($event.currentTarget.value);
						}
					}	
					</code></pre>
				</section>
				<section id="sweet-component-parent">
					<h2>In form markup</h2>
					<pre><code data-trim>
						<form  [formGroup]="myForm">
						  <div class="form-group">
						    <label for="name">Name</label>
                <my-sweet-component class="form-control" formControlName="name" ></my-sweet-component>
						  </div>
						</form>
					</code></pre>
				</section>
				<section id="two-way-val">
					<h2>Vals both ways!</h2>
					<pre><code data-trim>
					  export class MySweetComponent implements ControlValueAccessor {
						  @Input() _value: any;
						  ...
					</code></pre>
				</section>
				<section id="key-concepts">
					<h2>Key Concepts</h2>
					<ul>
						<li class="fragment">CVA is great for granular control of displaying
							<br /> to the UI &amp; communicating with the forms API</li>
						<li class="fragment">Keep your wrapper components dumb.</li>
						<li class="fragment">Just input and output form values!</li>
						<li class="fragment">Leave validation logic to the parent form component.</li>
					</ul>
				</section>
			
				<!----------------------------------------->
				<section id="questions">
					<h2>Questions?</h2>
					<img style="height:300px" class="plain" src="img/strangerconfused.gif" alt="Lash bae">
					<p>Slides available at: <a href="https://tehfedaykin.github.io/WormholesandCVAs/">tehfedaykin.github.io/WormholesandCVAs</a></p>
				</section>
			</div>
		</div>
		<div class="twitter-overlay">
			<span>@likeOMGitsFEDAY</span> <span>#WormholesandCVAs</span> <span>#ngconf2019</span>
		</div>
		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				width: 1280,
				height: 800,
				history: true,
				display: 'block',
				progress: true,
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});

			Reveal.addEventListener( 'slidechanged', function( event ) {
				// event.previousSlide, event.currentSlide, event.indexh, event.indexv
				if(event.currentSlide.getAttribute('id') === 'thankunext') {
					document.getElementById('conorvideo').play();
				}
			});
		</script>
	</body>
</html>
